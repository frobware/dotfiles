{{ if (eq .chezmoi.os "linux") -}}
{{ if (eq .chezmoi.osRelease.id "fedora") -}}
#!/usr/bin/env bash

set -euo pipefail

{{- $pkgs := list
     "direnv"
     "discount"
     "fzf"
     "git-crypt"
     "golang"
     "jq"
     "mosh"
     "notmuch"
     "pass"
     "sshfs"
     "the_silver_searcher"
     "wget" }}

echo dnf install --assumeyes {{ range $val := $pkgs }} {{ $val }} {{ end }} | sudo sh -x

{{ if (not .headless) -}}
version=2.242
if [ ! -f "$HOME/JetBrainsMono-${version}.zip" ]; then
   mkdir -p ~/.local/share/fonts
   tmpdir=$(mktemp -d)
   cleanup() {
       rm -rf ${tmpdir}
   }
   trap cleanup EXIT
   wget https://download.jetbrains.com/fonts/JetBrainsMono-${version}.zip
   unzip -d $tmpdir -x JetBrainsMono-${version}.zip
   cp -a $tmpdir/fonts/ttf/JetBrainsMono*.ttf ~/.local/share/fonts
   fc-cache -fv
fi
{{ end -}}

{{ end -}}
{{ end -}}
